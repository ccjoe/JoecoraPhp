!function(a){function b(c,d){var e={align:"center",valign:"center"};if(a.extend(e,d),0===c.height())return void c.load(function(){b(a(this),d)});var g,h,i,j=f(),k=j.width,l=j.height,m=c.width(),n=c.height(),o=l/k,p=n/m;o>p?(g=l/p,h=l):(g=k,h=k*p),i={width:g+"px",height:h+"px",top:"auto",bottom:"auto",left:"auto",right:"auto"},isNaN(parseInt(e.valign,10))?"top"==e.valign?i.top=0:"bottom"==e.valign?i.bottom=0:i.top=(l-h)/2:i.top=0-(h-l)/100*parseInt(e.valign,10)+"px",isNaN(parseInt(e.align,10))?"left"==e.align?i.left=0:"right"==e.align?i.right=0:i.left=(k-g)/2:i.left=0-(g-k)/100*parseInt(e.align,10)+"px",c.css(i)}function c(){j.prependTo("body").fadeIn()}function d(){j.fadeOut("fast",function(){a(this).remove()})}function e(){return a("body").css("backgroundImage")?a("body").css("backgroundImage").replace(/url\("?(.*?)"?\)/i,"$1"):void 0}function f(){var a=window,b="inner";return"innerWidth"in window||(a=document.documentElement||document.body,b="client"),{width:a[b+"Width"],height:a[b+"Height"]}}var g,h=a("<img />").addClass("vegas-background"),i=a("<div />").addClass("vegas-overlay"),j=a("<div />").addClass("vegas-loading"),k=a(),l=null,m=[],n=0,o=5e3,p=function(){},q={init:function(f){var g={src:e(),align:"center",valign:"center",fade:0,loading:!0,load:function(){},complete:function(){}};a.extend(g,a.vegas.defaults.background,f),g.loading&&c();var i=h.clone();return i.css({position:"fixed",left:"0px",top:"0px"}).bind("load",function(){i!=k&&(a(window).bind("load resize.vegas",function(){b(i,g)}),k.is("img")?(k.stop(),i.hide().insertAfter(k).fadeIn(g.fade,function(){a(".vegas-background").not(this).remove(),a("body").trigger("vegascomplete",[this,n-1]),g.complete.apply(i,[n-1])})):i.hide().prependTo("body").fadeIn(g.fade,function(){a("body").trigger("vegascomplete",[this,n-1]),g.complete.apply(this,[n-1])}),k=i,b(k,g),g.loading&&d(),a("body").trigger("vegasload",[k.get(0),n-1]),g.load.apply(k.get(0),[n-1]),n&&(a("body").trigger("vegaswalk",[k.get(0),n-1]),g.walk.apply(k.get(0),[n-1])))}).attr("src",g.src),a.vegas},destroy:function(b){return b&&"background"!=b||(a(".vegas-background, .vegas-loading").remove(),a(window).unbind("*.vegas"),k=a()),b&&"overlay"!=b||a(".vegas-overlay").remove(),clearInterval(g),a.vegas},overlay:function(b){var c={src:null,opacity:null};return a.extend(c,a.vegas.defaults.overlay,b),i.remove(),i.css({margin:"0",padding:"0",position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),c.src===!1&&i.css("backgroundImage","none"),c.src&&i.css("backgroundImage","url("+c.src+")"),c.opacity&&i.css("opacity",c.opacity),i.prependTo("body"),a.vegas},slideshow:function(b,c){var d={step:n,delay:o,preload:!1,loading:!0,backgrounds:m,walk:p};if(a.extend(d,a.vegas.defaults.slideshow,b),d.backgrounds!=m&&(b.step||(d.step=0),b.walk||(d.walk=function(){}),d.preload&&a.vegas("preload",d.backgrounds)),m=d.backgrounds,o=d.delay,n=d.step,p=d.walk,clearInterval(g),!m.length)return a.vegas;var e=function(){0>n&&(n=m.length-1),(n>=m.length||!m[n-1])&&(n=0);var b=m[n++];b.walk=d.walk,b.loading=d.loading,"undefined"==typeof b.fade&&(b.fade=d.fade),b.fade>d.delay&&(b.fade=d.delay),a.vegas(b)};return e(),c||(l=!1,a("body").trigger("vegasstart",[k.get(0),n-1])),l||(g=setInterval(e,d.delay)),a.vegas},next:function(){var b=n;return n&&(a.vegas("slideshow",{step:n},!0),a("body").trigger("vegasnext",[k.get(0),n-1,b-1])),a.vegas},previous:function(){var b=n;return n&&(a.vegas("slideshow",{step:n-2},!0),a("body").trigger("vegasprevious",[k.get(0),n-1,b-1])),a.vegas},jump:function(b){var c=n;return n&&(a.vegas("slideshow",{step:b},!0),a("body").trigger("vegasjump",[k.get(0),n-1,c-1])),a.vegas},stop:function(){var b=n;return n=0,l=null,clearInterval(g),a("body").trigger("vegasstop",[k.get(0),b-1]),a.vegas},pause:function(){return l=!0,clearInterval(g),a("body").trigger("vegaspause",[k.get(0),n-1]),a.vegas},get:function(a){return null===a||"background"==a?k.get(0):"overlay"==a?i.get(0):"step"==a?n-1:"paused"==a?l:void 0},preload:function(b){var c=[];for(var d in b)if(b[d].src){var e=document.createElement("img");e.src=b[d].src,c.push(e)}return a.vegas}};a.vegas=function(b){return q[b]?q[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void a.error("Method "+b+" does not exist"):q.init.apply(this,arguments)},a.vegas.defaults={background:{},slideshow:{},overlay:{}}}(jQuery),function(a){function b(b,c,d,e){var f=b.text().split(c),g="";f.length&&(a(f).each(function(a,b){g+='<span class="'+d+(a+1)+'">'+b+"</span>"+e}),b.empty().append(g))}var c={init:function(){return this.each(function(){b(a(this),"","char","")})},words:function(){return this.each(function(){b(a(this)," ","word"," ")})},lines:function(){return this.each(function(){var c="eefec303079ad17405c889e092e105b0";b(a(this).children("br").replaceWith(c).end(),c,"line","")})}};a.fn.lettering=function(b){return b&&c[b]?c[b].apply(this,[].slice.call(arguments,1)):"letters"!==b&&b?(a.error("Method "+b+" does not exist on jQuery.lettering"),this):c.init.apply(this,[].slice.call(arguments,0))}}(jQuery),function(a){function b(b,e){function f(a){g.song=a,g.showIndexInfo(g.getSongData()[0],g.getSongData()[0].abSong[0]),b.autoPlay?g.t=setTimeout(function(){g.initPlay()},b.timeout):!1,d.call(g,b)}var g=this;this.player=a(e),this.opts=b,c.call(this,b,f)}function c(b,c){function d(b){a.ajax({url:b,dataType:"json"}).done(c).fail(function(){alert("获取信息失败")})}return d(b.url),c}function d(b){function c(){if(!h.mediaCenter().paused){var b=a(this),c=e(event,b,"align");k.width(c*b.width()),h.mediaTime(c)}}function d(){var b=a(this);if(b.hasClass("next"))return h.mediaCenter().paused&&b.siblings().first().trigger("click"),void h.next();if(b.hasClass("prev"))return h.mediaCenter().paused&&b.siblings().first().trigger("click"),void h.prev();if(b.hasClass("pause"))return void h.pause();if(b.hasClass("play"))return 0===g?(clearTimeout(h.t),h.initPlay(),void g++):void h.play();if(b.hasClass("slist"))return void b.toggleClass("active");if(b.hasClass("lrc"))return b.toggleClass("active"),void(b.hasClass("active")?f.find(".lrc-area").fadeIn("slow"):f.find(".lrc-area").fadeOut("slow"));if(b.hasClass("fa-star")||b.hasClass("fa-heart"))return void b.toggleClass("active");if((b.hasClass("fa-random")||b.hasClass("fa-list-ul")||b.hasClass("fa-refresh"))&&!b.parent().hasClass("select"))return void b.parent().addClass("select").end().siblings().removeClass("hide");if(b.parent().hasClass("select"))return void a(this).parent().removeClass("select").end().siblings().addClass("hide");if((b.hasClass("fa-volume-off")||b.hasClass("fa-volume-up"))&&!b.parent().hasClass("v-select"))return void b.addClass("hide").parent().addClass("v-select").end().siblings().removeClass("hide");if(b.parent().hasClass("v-select")&&!b.hasClass("prog"))return a(this).parent().removeClass("v-select").end().siblings().addClass("hide"),b.hasClass("fa-volume-off")&&h.onMute(),void(b.hasClass("fa-volume-up")&&h.offMute());if(b.hasClass("prog")&&b.parent().hasClass("v-select")){var c=b.find(".prog-bar"),d=e(event,c,"verticle");return void h.setVolume(d)}}function e(a,b,c){var d,e,f;return"verticle"===c?(d=b.height(),e=b.offset().top,f=a.pageY,needVal=d+e-f):"align"===c&&(d=b.width(),e=b.offset().left,f=a.pageX,needVal=f-e),needVal=needVal>d?d:needVal,needVal=0>needVal?0:needVal,needVal/d}var f=this.player,g=0,h=this,i=this.mediaCenter(),j=f.find(".btn-area"),k=f.find(".progress");h.setVolume(i.volume),j.on("click",".btn",d),f.find(".prog-wrap").on("click",c),f.find('i[circletype="'+b.initCircle+'"]').removeClass("hide").siblings().addClass("hide"),b.autoHide&&setTimeout(function(){h.togglePlayer(f)},b.initTimeHide)}b.prototype={mediaCenter:function(){return a("#Media")[0]},getSongData:function(){return this.song.songData},initPlay:function(){switch(this.opts.initCircle){case"list":this.playIndex(0,0);break;case"random":this.random();break;case"single":this.playIndex(0,0)}},play:function(){this.mediaCenter().play(),this.toggleTimeShow(!0),this.rpClass("play","pause"),this.rpClass("fa-play","fa-pause"),this.lrcRealTimeMove()},pause:function(){this.mediaCenter().pause(),this.toggleTimeShow(!1),this.rpClass("pause","play"),this.rpClass("fa-pause","fa-play")},next:function(){var a=this.getLabel(),b=this.getCirType();"list"===b&&this.playIndex(a.ai,a.si+1),"random"===b&&this.random(),"single"===b&&this.single()},prev:function(){var a=this.getLabel(),b=this.getCirType();"list"===b&&this.playIndex(a.ai,a.si-1),"random"===b&&this.random(),"single"===b&&this.single()},random:function(){var a=this.getSongData(),b=a.length,c=Math.floor(Math.random()*b),d=a[c].abSong.length,e=Math.floor(Math.random()*d);this.playIndex(c,e)},single:function(){var a=this.getLabel();this.playIndex(a.ai,a.si)},onMute:function(){this.mediaCenter().muted=!0},offMute:function(){this.mediaCenter().muted=!1},playIndex:function(a,b){var c=this.mediaCenter(),d=this.getSongData();b>d[a].abSong.length-1?(a++,b=0):0>b&&(a--,b=a>=0?d[a].abSong.length-1:0),(a>d.length-1||0>a)&&(a=0,b=0);var e=d[a],f=d[a].abSong[b];c.src=f.src,this.toggleTimeShow(!1),this.play(),this.showIndexInfo(e,f),this.setLabel(c,a,b)},showIndexInfo:function(a,b){var c=this.player,d=c.find(".btn-title"),e=c.find(".img-area img")[0];d.find(".song-title").text(b.title).end().find(".song-author").text(b.artist).end().find(".song-desc").text(a.abName),e.src=b.cover,this.loadLrc(b)},setLabel:function(b,c,d){a(b).attr({ai:c,si:d})},getLabel:function(){var b=a(this.mediaCenter());return{ai:parseInt(b.attr("ai"),10),si:parseInt(b.attr("si"),10)}},getCirType:function(){return this.player.find(".circle i").not(".hide").attr("circletype")},rpClass:function(a,b){this.player.find("."+a).removeClass(a).addClass(b)},setVolume:function(a){var b=this.mediaCenter(),c=Math.ceil(100*a);b.volume=a,this.player.find(".prog-val").text(c).siblings().find(".prog-in").height(c)},mediaTime:function(a){function b(){return d.currentTime/d.duration*100+"%"}function c(){d.currentTime=a*d.duration}var d=this.mediaCenter();return void 0===a?b():c()},toggleTimeShow:function(a){var b=this;a?b.timerObj=setInterval(function(){var a=b.mediaTime();b.player.find(".progress").width(a),"100%"===a&&b.next()},1e3):(clearInterval(b.timerObj),clearInterval(b.lrcTimer))},loadLrc:function(b){var c=this;a.ajax({url:b.lrc}).done(function(a){var b=c.parseLrcFile(a);c.player.find(".lrc-html-wrap").html(b)}).fail(function(){c.player.find(".lrc-html-wrap").html("没有找到歌词!").css({"margin-top":"0"}),clearInterval(c.lrcTimer)})},parseLrcFile:function(a){function b(a){var b=a.replace(/\[\w\w\:(.*?)\]/g,function(){return arguments[1]||"暂无"});return b}for(var c=[],d={},e="",f=a.split("\n"),g=f.splice(0,4),h=(b(g[0]),b(g[1]),b(g[2]),0);h<f.length;h++)f[h].replace(/\[(\d*):(\d*)([\.|\:]\d*)\]/g,function(){var a=0|arguments[1],b=0|arguments[2],e=60*a+b;c.push(e);var f=arguments[arguments.length-1].replace(/\[\d\d:\d\d.\d\d]/g,"");d["t"+e]=f});c.sort(function(a,b){return a-b});for(var i=0;i<c.length;i++){var j=c[i];e+='<p class="lrc-line" data-timeLine="'+j+'">'+d["t"+j]+"</p>"}return e},lrcRealTimeMove:function(){function a(){var a=(d.currentTime/d.duration,f.find('p[data-timeline="'+d.currentTime.toFixed()+'"]'));if(a.length){var b=a.position().top-20;a.css("color","green").prev().css("color","#aaa"),f.animate({"margin-top":"-"+b},200)}}var b=this,c=this.player,d=this.mediaCenter(),e=c.find(".lrc-area");e.show(),c.find(".lrc").addClass("active");{var f=e.find(".lrc-html-wrap");f.find("p.lrc-line")}curLrcHeight=f.height(),b.lrcTimer=setInterval(a,1e3)},togglePlayer:function(a){a.hasClass("show")?a.animate({right:"-372px"},500,function(){a.removeClass("show").addClass("hide")}):a.hasClass("hide")&&a.animate({right:"0"},500,function(){a.removeClass("hide").addClass("show")})}},a.fn.extend({media:function(c){var d=[].slice.call(arguments,1);return this.each(function(){var e=a._data(this,"Media");if(!e){var f=a.extend(!0,{},a.fn.media.defaults,"object"==typeof c?c:{});e=new b(f,this),a._data(this,"Media",e)}"string"==typeof c&&"function"==typeof e[c]&&e[c].apply(e,d)})}}),a.fn.media.defaults={url:"data/music.json",mediaID:"Media",initCircle:"list",autoPlay:!0,timeout:0,autoHide:!0,initTimeHide:5e3,volumeFade:!0}}(jQuery);
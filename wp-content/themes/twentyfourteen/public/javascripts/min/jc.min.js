var _IE=function(){for(var a=3,b=document.createElement("div"),c=b.getElementsByTagName("i");b.innerHTML="<!--[if gt IE "+ ++a+"]><i></i><![endif]-->",c[0];);return a>4?a:!1}();_IE&&9>_IE&&($("div,section,nav").not("#progress").remove(),$("body").prepend('<div class="bie8"><div class="wrap"><p class="tips">您使用的ie浏览器及版本太OUT了!, SO看到的只是这...</p><p class="info">最佳推荐<a href="http://dlsw.baidu.com/sw-search-sp/gaosu/2014_03_26_17/bind1/14744/ChromeStandaloneSetup33.0.1750.154_14744_BDdl.exe">Google Chrome</a>, 在<a href="http://dlsw.baidu.com/sw-search-sp/soft/6f/11508/Opera_20.0.1387.91_Setup.1397118343.exe" >Opera</a>, <a href="http://dlsw.baidu.com/sw-search-sp/soft/51/11843/Firefox-setup28.0.0.5186.1395192905.exe">Firefox</a>, Safari上也可以有较好体验。</p><p class="info"><a href="http://dlsw.baidu.com/sw-search-sp/gaosu/2014_03_26_17/bind1/14744/ChromeStandaloneSetup33.0.1750.154_14744_BDdl.exe">点击下载</a></p><p class="info">或者 访问 <a href="http://www.joecora.com/?cat=10">其它页面</a></p><p class="ver">友情提示：您当前的浏览器是： ie '+_IE+"</p></div></div>")),function(b){var c={$menu:b("#menu"),$bclick:b("#cnNav"),$bl:b("#cnNav").find(".cn-nav-prev"),$br:b("#cnNav").find(".cn-nav-next"),$leftConAll:b("#ltbg, #conList"),$leftBg:b("#ltbg"),$leftCon:b("#conList"),$postList:b("#conList").find("#post"),$article:b("#article"),$img:b("#conList").find("#img"),$vedioList:b("#conList").find("#vedio"),$postListCon:b("#conList").find(".post-wrapper"),$imgWrap:b("#imgWarp"),$imgGL:b("#imgGL"),$imgGlList:b("#imgGlList"),$showMode:b("#showMode"),$returnGL:b("#returnGL"),$aboutCon:b(".about-con"),$headerTitle:b("#jc-header"),$loading:b("<span  class='fa fa-spinner fa-spin'></span>"),$ok:b('<span><i class="fa fa-ok"></i>发表成功，待审核后可见</span>'),$tips:b('<span><i class="fa fa-hand-o-right"></i>麻烦将*号项填写正确</span>'),$wrong:b('<i class="fa fa-plus"></i>'),$failing:b("<span class='error'><i class='fa fa-info-circle'></i>提交数据失败,原因为提交内容一致或太过频繁</span>"),$overing:b("<span class='suceess'><i class='fa fa-check-square'></i>加载数据完毕</span>"),index:0,bgs:[{src:"/wp-content/gallery/beach/img_9172-1.jpg",fade:4e3},{src:"/wp-content/gallery/park/img_9116-1.jpg",fade:4e3},{src:"/wp-content/gallery/beach/img_9162-1.jpg",fade:4e3},{src:"/wp-content/gallery/park/img_9150-1.jpg",fade:4e3},{src:"/wp-content/gallery/beach/img_9163-1.jpg",fade:4e3},{src:"/wp-content/gallery/park/img_9157-1.jpg",fade:4e3}],init:function(){this.$headerTitle.find("h2 a").lettering(),c.getAjaxPostData(5),c.PatternSet.initPattern(),c.VegasSet(),c.PageUISet()},PageUISet:function(){function a(){var a=b(this)[0].href;return d(a),o.$aboutCon.hide(),!1}function d(a){b.ajax({url:a,context:o.$article,beforeSend:function(){var a=b(this).find(".article-con");a.find(".jc-art").empty(),a.find(".jc-art").append(o.$loading),b(this).find(".close").off(),b(this).find(".size").off();var c=b(this);o.PatternSet.openItem(),o.PatternSet.$mbPattern.children().promise().done(function(){c.show()}).done(function(){o.PatternSet.$mbPattern.hide()})}}).done(function(c){var d=b(b.parseHTML(c)).find("#content").find("article.post, nav.post-navigation"),j=b(this),k=a.match(/\d+/);console.log(k);var l=e(k);return j.find(".article-con .jc-art").append(d,l),j.find(".close").click(f),j.find(".size").click(function(){b(this).hasClass("enlarge")?h(j):b(this).hasClass("mini")&&i(j)}),g(b("#article").find(".jc-art")),o.$article.find(".fa-spinner").remove(),!1}).fail(function(){alert("调用发生错误！")})}function e(a){var c=b("<div />");return c.attr({"data-thread-key":a,"data-url":"http://www.joecora.com"}),DUOSHUO.EmbedThread(c[0]),c}function f(){o.$article.hide(),o.PatternSet.$mbPattern.show(),o.PatternSet.disperse()}function g(a){a.find(".comments-link a").attr({href:function(){return"#"+b(this).attr("href").match(/[a-z]*$/)}}),a.find("a.comment-reply-link").each(function(){b(this).attr("href",b(this).attr("href").substring(1))}),a.find("#ds-thread").prepend("<a name='comments' />"),a.off(),a.on("click",".entry-meta a",function(){var a=b(this);if(a.parent().hasClass("entry-date"))return this.href="",!1;if(a.hasClass("url")){var c=this.href;return d(c),!1}}),a.on("click","h1.entry-title a",function(){var a=this.href;return d(a),!1})}function h(a){a.find(".article-bg").css({backgroundColor:"#000",Zindex:"100"}),a.animate({width:"65%",height:"80%"},200,function(){a.animate({"margin-top":-a.height()/2,top:"50%",left:"011x0px",right:"120px!important"})}),a.addClass("lg-con").find(".enlarge").removeClass("enlarge").addClass("mini"),n=!0}function i(a){a.find(".article-bg").css({backgroundColor:"#000",opacity:"0.8",Zindex:"100"}),a.animate({width:"400px",height:"400px"},200,function(){a.animate({"margin-top":-a.height()/2,top:"50%",left:"011x0px",right:"120px!important"})}),a.removeClass("lg-con").find(".mini").removeClass("mini").addClass("enlarge"),n=!1}function j(){b.ajax({url:"?page_id=213",context:o.$imgGL,dataType:"html",beforeSend:function(){o.$imgGL.append(o.$loading)}}).done(function(a){var c=this;$htmlDoc=b(b.parseHTML(a));var d=k($htmlDoc);this.append(d),this.find(".fa-spinner").remove(),this.on("click",".view a",function(){c.hide(),c.next().show();var a=b(this).parent().data("gl"),d=o.$imgGlList.find(".ngg-galleryoverview");return d.hide(),d.hasClass(a)?o.$imgGlList.find("."+a).show():l(this),!1}),o.$returnGL.click(function(){c.show(),c.next().hide()}),o.$showMode.on("click","button",function(){b(this).addClass("active").siblings().removeClass("active")})}).fail(function(){alert("调用发生错误！")})}function k(a){var c=a.find(".ngg-albumoverview"),d=c.find(".ngg-albumtitle"),e=c.find(".ngg-thumbnail a img"),f=c.find(".ngg-description"),g=c.find(".ngg-thumbnail a");galleryData=[],galleryItem=[];for(var h=0;h<d.length;h++)!function(){var a={galleryThumbSrc:e[h].src,galleryTitle:b(d[h]).text(),galleryDescription:b(f[h]).text(),galleryLinks:g[h].href};galleryData.push(a)}();var i="<% _.each(galleryData, function(item) { %> <div class='view view-tenth' data-gl='label-<%= item.galleryTitle %>'><a href='<%= item.galleryLinks %>'><img src='<%= item.galleryThumbSrc %>' /><div class='mask'><h2><%= item.galleryTitle %></h2><p><%= item.galleryDescription %></p></div></a></div> <% }); %>",j=_.template(i,galleryData);return j}function l(a){b.ajax({url:a.href,dataType:"html",context:o.$imgGlList,beforeSend:function(){this.append(o.$loading)}}).done(function(c){var d=b(b.parseHTML(c)).find(".ngg-galleryoverview");this.append(d.addClass(b(a).parent().data("gl"))),this.find(".fa-spinner").remove(),m()})}function m(){return b(".ngg-galleryoverview").off(),b(".ngg-galleryoverview").on("click",".ngg-gallery-thumbnail-box a",function(){if(modeClass=o.$showMode.find("button.active"),modeClass.hasClass("show-bgs")){var a=this.href,d={src:a,fade:4e3};c.loadImage(a,function(){c.triggerBgPic(d)})}else if(modeClass.hasClass("show-grid")){getCurrentGalleryName=b(".showGalleryName:visible").text(),$clonehtmlDoc=b(htmlDoc).clone();var e=$clonehtmlDoc.find(".dirlabel-"+getCurrentGalleryName).find(".image-mergin").addClass(getCurrentGalleryName+"-gridlabel"),f=b("<script type='text/javascript' src='/javascripts/MergingImageBoxes.js'></script>");b("body").find("."+getCurrentGalleryName+"-gridlabel")[0]||(b("body").append(e).append(f),b.vegas("pause"),b(".radial-gradient").css("background-color","rgba(0,0,0,0.6)"),o.$leftBg.trigger("click"));var g=b("#im_close");g.bind("click",function(){b(".image-mergin").remove(),b.vegas("pause"),b(".radial-gradient").css("background-color","rgba(0,0,0,0)"),o.$leftBg.trigger("click")})}else modeClass.hasClass("show-book")||alert("请选择浏览模式");return!1}),!1}var n,o=this,p=0;b(document).ajaxSend(function(){b("#progress").removeClass("done"),pcsBar(0,0)}).ajaxStart(function(){pcsBar(0,70)}).ajaxSuccess(function(){pcsBar(70,100)}),screen.width<600&&b("#musicPlayerWrap").remove(),b("#expando").hover(function(){o.$leftBg.css({opacity:.8,filter:"alpha(opacity=60)"})},function(){o.$leftBg.css({opacity:.5,filter:"alpha(opacity=50)"})}),o.$leftBg.click(function(){p++,p%2?o.$leftCon.hide().parents().find(".ltbg").animate({width:"10px"},200,function(){b(this).addClass("shrink")}):o.$leftBg.removeClass("shrink").animate({width:"100%"},{duration:200,queue:!0,specialEasing:{width:"linear",height:"easeOutBounce"},complete:function(){o.$leftCon.show()}})}),o.$postList.scroll(function(){b(this).find("ul.post-wrapper").height()-b(this).scrollTop()<450&&o.getAjaxPostData(5)}),this.$postList.on("click","ul li a",a),this.$vedioList.on("click",".ds-thread-title a",a),b("#user").on("click","h3",function(){b("#user").find(".lwa").toggle()}),o.$menu.on("click",".nav span.mn",function(){if(b(this).hasClass("postNav")){if(!o.$leftCon.is(":visible")||o.$postList.is(":visible")!==!1)return!1;o.$postList.slideDown().siblings().slideUp()}else if(b(this).hasClass("imgNav")){if(!o.$leftCon.is(":visible")||o.$img.is(":visible")!==!1)return!1;o.$img.slideDown().siblings().slideUp(),o.$imgGL.find(".view").length||j()}else if(b(this).hasClass("vedNav")){if(!o.$leftCon.is(":visible")||o.$vedioList.is(":visible")!==!1)return!1;b("#conList").find("section").slideUp().end().find(".vedio-list").slideDown();var a=b("#vedio");a.find("#ds-thread").length||a.prepend(e(195))}else b(this).hasClass("timeNav");return f(),!1}),b(".about-more").click(function(){o.$aboutCon.slideToggle(),b("#musicPlayerWrap").length&&musicPlayerSwitch("close"),o.$article.is(":hidden")||f(),b(this).hasClass("active")?(b(this).removeClass("active"),b(this).find("i").removeClass("fa-arrow-circle-o-down").addClass("fa-arrow-circle-o-up")):(b(this).addClass("active"),b(this).find("i").removeClass("fa-arrow-circle-o-up").addClass("fa-arrow-circle-o-down")),o.$aboutCon.find("li:first-child").addClass("active").find(" .about-item-desc").show().animate({width:"200px",margin:"10px"},200),o.$aboutCon.find("li:first-child").siblings().find(" .about-item-desc").removeClass("active").animate({width:"0",margin:"0"},200),o.$aboutCon.off(),o.$aboutCon.on("click","li a",function(){var a=b(this);return a.parent().hasClass("active")?!1:(a.parent().siblings().find(" .about-item-desc").animate({width:"0",margin:"0"},200),a.parent().addClass("active").siblings().removeClass("active"),a.next().show().animate({width:"200px",margin:"10px"},200),void 0)})}),b(".about-music").click(function(){o.$aboutCon.hide(),b("#musicPlayerWrap").length&&musicPlayerSwitch()}),b("#musicPlayerSwitch").on("click",function(){o.$aboutCon.hide(),musicPlayerSwitch()})},VegasSet:function(){var a=this;b.vegas("slideshow",{backgrounds:a.bgs,delay:8e3,preload:!0})("overlay",{src:"/wp-content/themes/twentyfourteen/public/images/overlays/mask.png",opacity:.8}),b("body").on("vegaswalk",function(b,d,e){var f=a.bgs[e?e-1:a.bgs.length-1].src,g=e==a.bgs.length-1?a.bgs[0].src:a.bgs[e+1].src;a.$bl.find("div").css("background-image","url("+c.fullOrThumb(f)+")"),a.$br.find("div").css("background-image","url("+c.fullOrThumb(g)+")")}),this.$bclick.on("click",".cn-nav-item",function(a){return b(".vegas-background").stop(),-1!==a.currentTarget.className.indexOf("cn-nav-prev")&&b.vegas("previous"),-1!==a.currentTarget.className.indexOf("cn-nav-next")&&b.vegas("next"),!1})},getAjaxPostData:function(a){var c=this;b.ajax({url:"?feed=rss2",dataType:"xml",beforeSend:function(){c.$postListCon.append(c.$loading)}}).done(function(d){var e=b(d).find("channel item"),f=e.length;if(a*c.index>f)c.$postListCon.find(c.$loading,c.$overing).remove();else{var g=a*(c.index+1)>f?_.last(_.first(e,a*(c.index+1)),f-a):_.last(_.first(e,a*(c.index+1)),a),h=[];b(g).each(function(){var a=b('<li><a href="'+b(this).find("link").text()+'">'+b(this).find("title").text()+'</a><span class="post-date">'+b(this).find("description").text()+"</span></li>");h.push(a)}),c.$postListCon.find(c.$loading,c.$overing).remove().end().append(h)}c.index++}).fail(function(){c.$postListCon.find(loading,overing).remove().end().append(c.$failing)})},PatternSet:{$mbPattern:b("#mb_pattern"),initPattern:function(){for(var c=0;16>c;++c)this.showItem("50px","50px"),$el=b("<div>").css(param),$el.css("transform","rotate("+a+"deg)"),$el.appendTo(this.$mbPattern)},disperse:function(){pt=this,this.$mbPattern.children().each(function(){pt.showItem("50px","50px"),$el=b(this),$el.css("transform","rotate("+a+"deg)"),$el.animate(param,1e3)})},showItem:function(b,c){var e=.2,g=Math.floor(171*Math.random())+30,h=Math.floor(496*Math.random())+5,i=Math.floor(255*Math.random()),j=Math.floor(255*Math.random()),k=Math.floor(255*Math.random());a=Math.floor(101*Math.random())-50,d=1.5+.5*Math.random(),f=5*Math.random(),param={width:b,height:c,opacity:e,top:g+"px",right:h+"px",backgroundColor:"rgb("+i+","+j+","+k+")",borderRadius:d+"em",webkitFilter:"blur("+f+"px)"}},openItem:function(){this.$mbPattern.children().each(function(a){var c=b(this),d={width:"100px",height:"100px",top:188+100*Math.floor(a/4),right:100*(a%4),opacity:.2,backgroundColor:"rgb(0,0,0)",borderRadius:"0",webkitFilter:"blur(0px)"};c.css("transform","rotate(0deg)"),c.animate(d,1e3,"swing")})}},triggerBgPic:function(a){var d=c.bgs;_.contains(_.pluck(d,"src"),a.src)?b.vegas("jump",_.indexOf(d,a-1)):(d.push(a),d.length>15&&d.shift(),b.vegas("jump",d.length-1))},fullOrThumb:function(a){var b,c,d;return-1===a.indexOf("/thumbs/")?(b=a.lastIndexOf("/")+1,c=a.substring(0,b)+"thumbs/thumbs_"+a.substring(b)):(b=a.indexOf("/thumbs/"),d=a.substring(0,b)+"/"+a.substring(b+7)),c||d},loadImage:function(a,b){var c=new Image;return c.src=a,c.complete?void b.call(c):void(c.onload=function(){b.call(c)})}};c.init()}(jQuery,document);